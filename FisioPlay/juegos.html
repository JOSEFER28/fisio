<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>FisioPlay - Juegos</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>üß† Juegos Educativos</h1>
  </header>

  <section>
    <h2>Quiz de Anatom√≠a</h2>
    <button onclick="iniciarQuiz()">Jugar</button>
    <div id="juego"></div>
  </section>

  <!-- Firebase y l√≥gica del juego -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-analytics.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCWlAZgu46KpaFmH_I5CVVj0hPG3Q8Jyak",
      authDomain: "fisio-c3d93.firebaseapp.com",
      projectId: "fisio-c3d93",
      storageBucket: "fisio-c3d93.firebasestorage.app",
      messagingSenderId: "965156034612",
      appId: "1:965156034612:web:6e267b670c8d3f727e9261",
      measurementId: "G-X6Q0MRR7V1"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);

    const preguntas = [
      {
        pregunta: "¬øCu√°l m√∫sculo forma parte del suelo p√©lvico?",
        opciones: ["Trapecio", "Pubococc√≠geo", "Deltoides"],
        correcta: "Pubococc√≠geo"
      },
      {
        pregunta: "¬øD√≥nde est√° el m√∫sculo psoas?",
        opciones: ["Pierna", "Abdomen", "Brazo"],
        correcta: "Abdomen"
      }
    ];

    function iniciarQuiz() {
      const juego = document.getElementById("juego");
      let index = 0;
      let puntaje = 0;

      function mostrarPregunta() {
        if (index >= preguntas.length) {
          juego.innerHTML = `<h3>Tu puntuaci√≥n: ${puntaje}/${preguntas.length}</h3>`;
          guardarResultado("usuarioEjemplo", puntaje, "Quiz de Anatom√≠a");
          return;
        }

        const actual = preguntas[index];
        let html = `<h2>${actual.pregunta}</h2>`;
        actual.opciones.forEach(op => {
          html += `<button onclick="elegirRespuesta('${op}')">${op}</button>`;
        });

        juego.innerHTML = html;
      }

      window.elegirRespuesta = function(opcion) {
        if (opcion === preguntas[index].correcta) puntaje++;
        index++;
        mostrarPregunta();
      };

      mostrarPregunta();
    }

    window.iniciarQuiz = iniciarQuiz;

    async function guardarResultado(usuarioId, puntaje, juego) {
      try {
        await addDoc(collection(db, "resultados"), {
          usuario: usuarioId,
          juego: juego,
          puntaje: puntaje,
          fecha: new Date().toISOString()
        });
        alert("‚úÖ Resultado guardado correctamente");
      } catch (error) {
        console.error("Error al guardar:", error);
      }
    }
  </script>
</body>
</html>